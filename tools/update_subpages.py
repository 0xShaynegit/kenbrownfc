import os
import re
import base64

pages_dir = r'C:\ZZZWebsites\kenbrownfc\pages'

nav_files = [
    'corporate-services.html',
    'expat-resources-thailand.html',
    'financial-101.html',
    'getting-started-guide.html',
    'insurance-coverage-guide.html',
    'investment-strategy-expats.html',
    'property-real-estate.html',
    'retirement-planning-expats.html',
    'risk-management-guide.html',
    'tax-planning-expats.html',
    'trust-services.html',
    'wills-estate-planning-expats.html',
]

footer_script_only = ['claims-and-protection.html']

_nav_b64 = 'ICAgIDwhLS0gTmF2aWdhdGlvbiBCYXIgLS0+CiAgICA8bmF2IGNsYXNzPSJuYXZiYXIiIGlkPSJuYXZiYXIiPgogICAgICAgIDxkaXYgY2xhc3M9Im5hdmJhci1jb250YWluZXIiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJuYXZiYXItYnJhbmQiPjxhIGhyZWY9Ii4uL2luZGV4Lmh0bWwiIHN0eWxlPSJjb2xvcjogaW5oZXJpdDsgdGV4dC1kZWNvcmF0aW9uOiBub25lOyI+S2VuIEJyb3duIEZpbmFuY2lhbCBDb25zdWx0YW50PC9hPjwvZGl2PgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJuYXZiYXItdG9nZ2xlIiBpZD0ibmF2YmFyLXRvZ2dsZSIgYXJpYS1sYWJlbD0iT3BlbiBuYXZpZ2F0aW9uIG1lbnUiIGFyaWEtZXhwYW5kZWQ9ImZhbHNlIiBhcmlhLWNvbnRyb2xzPSJtb2JpbGUtZHJhd2VyIj4KICAgICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuPjwvc3Bhbj4KICAgICAgICAgICAgPC9idXR0b24+CiAgICAgICAgICAgIDx1bCBjbGFzcz0ibmF2YmFyLW1lbnUiIGlkPSJuYXZiYXItbWVudSIgcm9sZT0ibWVudWJhciI+CiAgICAgICAgICAgICAgICA8bGkgcm9sZT0ibm9uZSI+PGEgY2xhc3M9Im5hdmJhci1saW5rIiBocmVmPSIuLi9pbmRleC5odG1sI2Fib3V0IiByb2xlPSJtZW51aXRlbSI+QWJvdXQgS2VuPC9hPjwvbGk+CiAgICAgICAgICAgICAgICA8bGkgY2xhc3M9Im5hdi1oYXMtbWVnYSIgcm9sZT0ibm9uZSI+CiAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9Im5hdmJhci1saW5rIiBocmVmPSIuLi9pbmRleC5odG1sI3NlcnZpY2VzIiByb2xlPSJtZW51aXRlbSIgYXJpYS1oYXNwb3B1cD0idHJ1ZSIgYXJpYS1leHBhbmRlZD0iZmFsc2UiIGlkPSJzZXJ2aWNlcy1tZW51LXRyaWdnZXIiPlNlcnZpY2VzICYjOTY2Mjs8L2E+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVnYS1tZW51IiByb2xlPSJtZW51IiBhcmlhLWxhYmVsbGVkYnk9InNlcnZpY2VzLW1lbnUtdHJpZ2dlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1lZ2EtbWVudS1pbm5lciI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZWdhLWNvbCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVnYS1oZWFkaW5nIj5QZXJzb25hbCBGaW5hbmNlPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9Im1lZ2EtbGluayIgaHJlZj0icmV0aXJlbWVudC1wbGFubmluZy1leHBhdHMuaHRtbCIgcm9sZT0ibWVudWl0ZW0iPlJldGlyZW1lbnQgUGxhbm5pbmc8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9Im1lZ2EtbGluayIgaHJlZj0iaW52ZXN0bWVudC1zdHJhdGVneS1leHBhdHMuaHRtbCIgcm9sZT0ibWVudWl0ZW0iPkludmVzdG1lbnQgU3RyYXRlZ3k8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9Im1lZ2EtbGluayIgaHJlZj0idGF4LXBsYW5uaW5nLWV4cGF0cy5odG1sIiByb2xlPSJtZW51aXRlbSI+VGF4IFBsYW5uaW5nPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJtZWdhLWxpbmsiIGhyZWY9ImV4cGF0LXJlc291cmNlcy10aGFpbGFuZC5odG1sIiByb2xlPSJtZW51aXRlbSI+RXhwYXQgUmVzb3VyY2VzPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZWdhLWNvbCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVnYS1oZWFkaW5nIj5Qcm9wZXJ0eSAmYW1wOyBDb3Jwb3JhdGU8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0ibWVnYS1saW5rIiBocmVmPSJwcm9wZXJ0eS1yZWFsLWVzdGF0ZS5odG1sIiByb2xlPSJtZW51aXRlbSI+UHJvcGVydHkgJmFtcDsgUmVhbCBFc3RhdGU8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9Im1lZ2EtbGluayIgaHJlZj0iY29ycG9yYXRlLXNlcnZpY2VzLmh0bWwiIHJvbGU9Im1lbnVpdGVtIj5Db3Jwb3JhdGUgU2VydmljZXM8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVnYS1oZWFkaW5nIG10Ij5MZWFybmluZyBSZXNvdXJjZXM8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0ibWVnYS1saW5rIiBocmVmPSJmaW5hbmNpYWwtMTAxLmh0bWwiIHJvbGU9Im1lbnVpdGVtIj5GaW5hbmNpYWwgMTAxPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJtZWdhLWxpbmsiIGhyZWY9ImdldHRpbmctc3RhcnRlZC1ndWlkZS5odG1sIiByb2xlPSJtZW51aXRlbSI+R2V0dGluZyBTdGFydGVkPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJtZWdhLWNvbCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ibWVnYS1oZWFkaW5nIj5Qcm90ZWN0aW9uICZhbXA7IEVzdGF0ZTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJtZWdhLWxpbmsiIGhyZWY9IndpbGxzLWVzdGF0ZS1wbGFubmluZy1leHBhdHMuaHRtbCIgcm9sZT0ibWVudWl0ZW0iPldpbGxzICZhbXA7IEVzdGF0ZTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0ibWVnYS1saW5rIiBocmVmPSJ0cnVzdC1zZXJ2aWNlcy5odG1sIiByb2xlPSJtZW51aXRlbSI+VHJ1c3QgU2VydmljZXM8L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9Im1lZ2EtbGluayIgaHJlZj0iY2xhaW1zLWFuZC1wcm90ZWN0aW9uLmh0bWwiIHJvbGU9Im1lbnVpdGVtIj5Bc3NldCBQcm90ZWN0aW9uPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJtZWdhLWxpbmsiIGhyZWY9Imluc3VyYW5jZS1jb3ZlcmFnZS1ndWlkZS5odG1sIiByb2xlPSJtZW51aXRlbSI+SW5zdXJhbmNlIENvdmVyYWdlPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJtZWdhLWxpbmsiIGhyZWY9InJpc2stbWFuYWdlbWVudC1ndWlkZS5odG1sIiByb2xlPSJtZW51aXRlbSI+UmlzayBNYW5hZ2VtZW50PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9saT4KICAgICAgICAgICAgICAgIDxsaSByb2xlPSJub25lIj48YSBjbGFzcz0ibmF2YmFyLWxpbmsiIGhyZWY9Ii4uL2luZGV4Lmh0bWwjZXhwZXJ0aXNlIiByb2xlPSJtZW51aXRlbSI+RXhwZXJ0aXNlPC9hPjwvbGk+CiAgICAgICAgICAgICAgICA8bGkgcm9sZT0ibm9uZSI+PGEgY2xhc3M9Im5hdmJhci1saW5rIiBocmVmPSIuLi9pbmRleC5odG1sI2NvbnRhY3QiIHJvbGU9Im1lbnVpdGVtIj5Db250YWN0PC9hPjwvbGk+CiAgICAgICAgICAgICAgICA8bGkgcm9sZT0ibm9uZSI+PGEgY2xhc3M9Im5hdmJhci1saW5rIiBocmVmPSJ3aWxscy1lc3RhdGUtcGxhbm5pbmctZXhwYXRzLmh0bWwiIHJvbGU9Im1lbnVpdGVtIj5XaWxscyAmYW1wOyBFc3RhdGU8L2E+PC9saT4KICAgICAgICAgICAgICAgIDxsaSByb2xlPSJub25lIj48YSBjbGFzcz0ibmF2YmFyLWN0YSIgaHJlZj0iaHR0cHM6Ly9tLm1lL2tlbmJyb3duZmMiIHJvbGU9Im1lbnVpdGVtIj5DT05UQUNUIEtFTjwvYT48L2xpPgogICAgICAgICAgICA8L3VsPgogICAgICAgIDwvZGl2PgogICAgPC9uYXY+CiAgICA8IS0tIE1vYmlsZSBvdmVybGF5IC0tPgogICAgPGRpdiBjbGFzcz0ibW9iaWxlLW92ZXJsYXkiIGlkPSJtb2JpbGUtb3ZlcmxheSIgYXJpYS1oaWRkZW49InRydWUiPjwvZGl2PgogICAgPCEtLSBNb2JpbGUgc2xpZGUtb3V0IGRyYXdlciAtLT4KICAgIDxkaXYgY2xhc3M9Im1vYmlsZS1kcmF3ZXIiIGlkPSJtb2JpbGUtZHJhd2VyIiByb2xlPSJkaWFsb2ciIGFyaWEtbW9kYWw9InRydWUiIGFyaWEtbGFiZWw9Ik5hdmlnYXRpb24gbWVudSIgYXJpYS1oaWRkZW49InRydWUiIHRhYmluZGV4PSItMSI+CiAgICAgICAgPGRpdiBjbGFzcz0ibW9iaWxlLWRyYXdlci1oZWFkZXIiPgogICAgICAgICAgICA8c3BhbiBjbGFzcz0ibW9iaWxlLWRyYXdlci1icmFuZCI+S2VuIEJyb3duIEZDPC9zcGFuPgogICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJtb2JpbGUtZHJhd2VyLWNsb3NlIiBpZD0ibW9iaWxlLWRyYXdlci1jbG9zZSIgYXJpYS1sYWJlbD0iQ2xvc2UgbmF2aWdhdGlvbiBtZW51Ij4mIzEwMDA1OzwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgICAgIDxuYXYgY2xhc3M9Im1vYmlsZS1kcmF3ZXItbmF2IiBhcmlhLWxhYmVsPSJNYWluIG5hdmlnYXRpb24iPgogICAgICAgICAgICA8dWw+CiAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iLi4vaW5kZXguaHRtbCNhYm91dCI+QWJvdXQgS2VuPC9hPjwvbGk+CiAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iLi4vaW5kZXguaHRtbCNzZXJ2aWNlcyI+U2VydmljZXM8L2E+PC9saT4KICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSIuLi9pbmRleC5odG1sI2V4cGVydGlzZSI+RXhwZXJ0aXNlPC9hPjwvbGk+CiAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iLi4vaW5kZXguaHRtbCNjb250YWN0Ij5Db250YWN0PC9hPjwvbGk+CiAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0id2lsbHMtZXN0YXRlLXBsYW5uaW5nLWV4cGF0cy5odG1sIj5XaWxscyAmYW1wOyBFc3RhdGU8L2E+PC9saT4KICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSJodHRwczovL20ubWUva2VuYnJvd25mYyIgY2xhc3M9Im1vYmlsZS1jdGEtbGluayI+Q29udGFjdCBLZW4gJiM4NTk0OzwvYT48L2xpPgogICAgICAgICAgICA8L3VsPgogICAgICAgIDwvbmF2PgogICAgICAgIDxkaXYgY2xhc3M9Im1vYmlsZS1kcmF3ZXItY2F0ZWdvcmllcyIgYXJpYS1sYWJlbD0iU2VydmljZSBjYXRlZ29yaWVzIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9iaWxlLWNhdC10aXRsZSI+Q2F0ZWdvcmllczwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJtb2JpbGUtY2F0LWdyb3VwIj4KICAgICAgICAgICAgICAgIDxoND5QZXJzb25hbCBGaW5hbmNlPC9oND4KICAgICAgICAgICAgICAgIDxhIGhyZWY9InJldGlyZW1lbnQtcGxhbm5pbmctZXhwYXRzLmh0bWwiPlJldGlyZW1lbnQgUGxhbm5pbmc8L2E+CiAgICAgICAgICAgICAgICA8YSBocmVmPSJpbnZlc3RtZW50LXN0cmF0ZWd5LWV4cGF0cy5odG1sIj5JbnZlc3RtZW50IFN0cmF0ZWd5PC9hPgogICAgICAgICAgICAgICAgPGEgaHJlZj0idGF4LXBsYW5uaW5nLWV4cGF0cy5odG1sIj5UYXggUGxhbm5pbmc8L2E+CiAgICAgICAgICAgICAgICA8YSBocmVmPSJleHBhdC1yZXNvdXJjZXMtdGhhaWxhbmQuaHRtbCI+RXhwYXQgUmVzb3VyY2VzPC9hPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9iaWxlLWNhdC1ncm91cCI+CiAgICAgICAgICAgICAgICA8aDQ+UHJvcGVydHkgJmFtcDsgQ29ycG9yYXRlPC9oND4KICAgICAgICAgICAgICAgIDxhIGhyZWY9InByb3BlcnR5LXJlYWwtZXN0YXRlLmh0bWwiPlByb3BlcnR5ICZhbXA7IFJlYWwgRXN0YXRlPC9hPgogICAgICAgICAgICAgICAgPGEgaHJlZj0iY29ycG9yYXRlLXNlcnZpY2VzLmh0bWwiPkNvcnBvcmF0ZSBTZXJ2aWNlczwvYT4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9Im1vYmlsZS1jYXQtZ3JvdXAiPgogICAgICAgICAgICAgICAgPGg0PlByb3RlY3Rpb24gJmFtcDsgRXN0YXRlPC9oND4KICAgICAgICAgICAgICAgIDxhIGhyZWY9IndpbGxzLWVzdGF0ZS1wbGFubmluZy1leHBhdHMuaHRtbCI+V2lsbHMgJmFtcDsgRXN0YXRlPC9hPgogICAgICAgICAgICAgICAgPGEgaHJlZj0idHJ1c3Qtc2VydmljZXMuaHRtbCI+VHJ1c3QgU2VydmljZXM8L2E+CiAgICAgICAgICAgICAgICA8YSBocmVmPSJjbGFpbXMtYW5kLXByb3RlY3Rpb24uaHRtbCI+QXNzZXQgUHJvdGVjdGlvbjwvYT4KICAgICAgICAgICAgICAgIDxhIGhyZWY9Imluc3VyYW5jZS1jb3ZlcmFnZS1ndWlkZS5odG1sIj5JbnN1cmFuY2UgQ292ZXJhZ2U8L2E+CiAgICAgICAgICAgICAgICA8YSBocmVmPSJyaXNrLW1hbmFnZW1lbnQtZ3VpZGUuaHRtbCI+UmlzayBNYW5hZ2VtZW50PC9hPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibW9iaWxlLWNhdC1ncm91cCI+CiAgICAgICAgICAgICAgICA8aDQ+TGVhcm5pbmcgUmVzb3VyY2VzPC9oND4KICAgICAgICAgICAgICAgIDxhIGhyZWY9ImZpbmFuY2lhbC0xMDEuaHRtbCI+RmluYW5jaWFsIDEwMTwvYT4KICAgICAgICAgICAgICAgIDxhIGhyZWY9ImdldHRpbmctc3RhcnRlZC1ndWlkZS5odG1sIj5HZXR0aW5nIFN0YXJ0ZWQ8L2E+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+'
_script_b64 = 'ICAgIDxzY3JpcHQ+CiAgICAgICAgY29uc3QgbmF2YmFyICAgICAgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYXZiYXInKTsKICAgICAgICBjb25zdCBuYXZiYXJUb2dnbGUgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hdmJhci10b2dnbGUnKTsKICAgICAgICBjb25zdCBtb2JpbGVPdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vYmlsZS1vdmVybGF5Jyk7CiAgICAgICAgY29uc3QgbW9iaWxlRHJhd2VyICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2JpbGUtZHJhd2VyJyk7CiAgICAgICAgY29uc3QgZHJhd2VyQ2xvc2UgICA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2JpbGUtZHJhd2VyLWNsb3NlJyk7CiAgICAgICAgY29uc3Qgc2VydmljZXNUcmlnZ2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlcnZpY2VzLW1lbnUtdHJpZ2dlcicpOwogICAgICAgIGNvbnN0IG5hdkhhc01lZ2EgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2LWhhcy1tZWdhJyk7CgogICAgICAgIC8vIC0tLSBOYXZiYXIgc2Nyb2xsIGVmZmVjdCAtLS0KICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgKCkgPT4gewogICAgICAgICAgICBuYXZiYXIuY2xhc3NMaXN0LnRvZ2dsZSgnc2Nyb2xsZWQnLCB3aW5kb3cuc2Nyb2xsWSA+IDUwKTsKICAgICAgICB9KTsKCiAgICAgICAgLy8gLS0tIE1vYmlsZSBkcmF3ZXIgLS0tCiAgICAgICAgZnVuY3Rpb24gb3BlbkRyYXdlcigpIHsKICAgICAgICAgICAgbW9iaWxlRHJhd2VyLmNsYXNzTGlzdC5hZGQoJ29wZW4nKTsKICAgICAgICAgICAgbW9iaWxlT3ZlcmxheS5jbGFzc0xpc3QuYWRkKCdvcGVuJyk7CiAgICAgICAgICAgIG1vYmlsZURyYXdlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJyk7CiAgICAgICAgICAgIG1vYmlsZU92ZXJsYXkuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpOwogICAgICAgICAgICBuYXZiYXJUb2dnbGUuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTsKICAgICAgICAgICAgbmF2YmFyVG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7CiAgICAgICAgICAgIG1vYmlsZURyYXdlci5mb2N1cygpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY2xvc2VEcmF3ZXIoKSB7CiAgICAgICAgICAgIG1vYmlsZURyYXdlci5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7CiAgICAgICAgICAgIG1vYmlsZU92ZXJsYXkuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpOwogICAgICAgICAgICBtb2JpbGVEcmF3ZXIuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICAgIG1vYmlsZU92ZXJsYXkuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICAgIG5hdmJhclRvZ2dsZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTsKICAgICAgICAgICAgbmF2YmFyVG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7CiAgICAgICAgICAgIG5hdmJhclRvZ2dsZS5mb2N1cygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG5hdmJhclRvZ2dsZSkgewogICAgICAgICAgICBuYXZiYXJUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBtb2JpbGVEcmF3ZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJykgPyBjbG9zZURyYXdlcigpIDogb3BlbkRyYXdlcigpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgaWYgKGRyYXdlckNsb3NlKSAgIGRyYXdlckNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VEcmF3ZXIpOwogICAgICAgIGlmIChtb2JpbGVPdmVybGF5KSBtb2JpbGVPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VEcmF3ZXIpOwoKICAgICAgICAvLyBDbG9zZSBkcmF3ZXIgb24gYW55IGxpbmsgdGFwIGluc2lkZQogICAgICAgIGlmIChtb2JpbGVEcmF3ZXIpIHsKICAgICAgICAgICAgbW9iaWxlRHJhd2VyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2EnKS5mb3JFYWNoKGxpbmsgPT4gewogICAgICAgICAgICAgICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRHJhd2VyKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICAvLyBFc2NhcGUga2V5IGNsb3NlcyBib3RoIGRyYXdlciBhbmQgbWVnYSBtZW51CiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4gewogICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7CiAgICAgICAgICAgICAgICBpZiAobW9iaWxlRHJhd2VyICYmIG1vYmlsZURyYXdlci5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKSkgY2xvc2VEcmF3ZXIoKTsKICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlc1RyaWdnZXIpIHNlcnZpY2VzVHJpZ2dlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyAtLS0gRGVza3RvcCBtZWdhIG1lbnU6IEFSSUEgc3RhdGUgc3luYyAtLS0KICAgICAgICBpZiAoc2VydmljZXNUcmlnZ2VyICYmIG5hdkhhc01lZ2EpIHsKICAgICAgICAgICAgbmF2SGFzTWVnYS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gewogICAgICAgICAgICAgICAgc2VydmljZXNUcmlnZ2VyLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBuYXZIYXNNZWdhLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBzZXJ2aWNlc1RyaWdnZXIuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBuYXZIYXNNZWdhLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBzZXJ2aWNlc1RyaWdnZXIuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIG5hdkhhc01lZ2EuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNvdXQnLCBlID0+IHsKICAgICAgICAgICAgICAgIGlmICghbmF2SGFzTWVnYS5jb250YWlucyhlLnJlbGF0ZWRUYXJnZXQpKSB7CiAgICAgICAgICAgICAgICAgICAgc2VydmljZXNUcmlnZ2VyLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIC0tLSBTbW9vdGggc2Nyb2xsIGZvciBhbmNob3IgbGlua3MgLS0tCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYVtocmVmXj0iIyJdJykuZm9yRWFjaChhbmNob3IgPT4gewogICAgICAgICAgICBhbmNob3IuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuZ2V0QXR0cmlidXRlKCdocmVmJykpOwogICAgICAgICAgICAgICAgaWYgKHRhcmdldCkgdGFyZ2V0LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIDwvc2NyaXB0Pg=='
NEW_NAV = base64.b64decode(_nav_b64).decode('utf-8')
NEW_SCRIPT = base64.b64decode(_script_b64).decode('utf-8')

def process_file(filepath, do_nav):
    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()
    original = content
    if do_nav:
        content, n = re.subn(
            r'    <nav class="navbar" id="navbar">.*?    </nav>',
            NEW_NAV,
            content,
            count=1,
            flags=re.DOTALL
        )
        if n == 0:
            print(f'  WARNING: nav pattern not found in {os.path.basename(filepath)}')
        else:
            print(f'  nav replaced')
    old_footer = '<div class="footer-content" style="grid-template-columns: 2fr 1fr 1fr 1fr 1fr; max-width: 1400px;">'
    new_footer = '<div class="footer-content">'
    if old_footer in content:
        content = content.replace(old_footer, new_footer, 1)
        print(f'  footer fixed')
    else:
        print(f'  WARNING: footer inline style not found in {os.path.basename(filepath)}')
    content, n = re.subn(
        "    <script>\\s+const navbar = document\\.getElementById\\('navbar'\\);\\s+window\\.addEventListener\\('scroll'.*?    </script>",
        NEW_SCRIPT,
        content,
        count=1,
        flags=re.DOTALL
    )
    if n == 0:
        print(f'  WARNING: old script pattern not found in {os.path.basename(filepath)}')
    else:
        print(f'  script replaced')
    if content != original:
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f'  SAVED')
    else:
        print(f'  no changes made')

print('=== Updating subpage nav/footer/script ===')
for filename in nav_files:
    filepath = os.path.join(pages_dir, filename)
    print(f'\nProcessing: {filename}')
    process_file(filepath, do_nav=True)
for filename in footer_script_only:
    filepath = os.path.join(pages_dir, filename)
    print(f'\nProcessing (footer+script only): {filename}')
    process_file(filepath, do_nav=False)
print('\n=== Done ===')
